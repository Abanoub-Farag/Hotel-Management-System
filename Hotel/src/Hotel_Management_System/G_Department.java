package Hotel_Management_System;import net.proteanit.sql.DbUtils;import javax.swing.*;import javax.swing.table.DefaultTableCellRenderer;import javax.swing.table.JTableHeader;import java.awt.*;import java.awt.event.ActionEvent;import java.awt.event.ActionListener;import java.sql.ResultSet;public class G_Department extends JFrame {    JTable table;    JScrollPane scrollPane;    JPanel statsPanel;    private JPanel mainPanel;    private JPanel contentPanel;    private JPanel tablePanel;    G_Department(){        super("Department Management");        // Use layered pane for proper painting order        JLayeredPane layeredPane = new JLayeredPane();        layeredPane.setPreferredSize(new Dimension(900, 650));        // Background panel - painted first        mainPanel = new JPanel(new BorderLayout()) {            @Override            protected void paintComponent(Graphics g) {                super.paintComponent(g);                Graphics2D g2d = (Graphics2D) g;                g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);                GradientPaint gradient = new GradientPaint(                        0, 0, new Color(15, 30, 45),                        getWidth(), getHeight(), new Color(60, 20, 60)                );                g2d.setPaint(gradient);                g2d.fillRect(0, 0, getWidth(), getHeight());            }        };        mainPanel.setBounds(0, 0, 900, 650);        mainPanel.setOpaque(false);        layeredPane.add(mainPanel, JLayeredPane.DEFAULT_LAYER);        // Content panel with solid background        contentPanel = new JPanel(new GridBagLayout());        contentPanel.setBounds(20, 20, 860, 610);        contentPanel.setBackground(new Color(255, 255, 255, 10)); // Very light transparency        contentPanel.setBorder(BorderFactory.createEmptyBorder(20, 20, 20, 20));        layeredPane.add(contentPanel, JLayeredPane.PALETTE_LAYER);        GridBagConstraints gbc = new GridBagConstraints();        gbc.fill = GridBagConstraints.HORIZONTAL;        gbc.weightx = 1.0;        gbc.insets = new Insets(0, 0, 15, 0);        // Title panel - solid background        JPanel titlePanel = new JPanel(new BorderLayout());        titlePanel.setOpaque(false);        JLabel titleLabel = new JLabel("üè¢ DEPARTMENT MANAGEMENT");        titleLabel.setFont(new Font("Segoe UI", Font.BOLD, 32));        titleLabel.setForeground(new Color(255, 215, 0));        titleLabel.setHorizontalAlignment(SwingConstants.CENTER);        titleLabel.setBorder(BorderFactory.createEmptyBorder(0, 0, 10, 0));        titlePanel.add(titleLabel, BorderLayout.CENTER);        JLabel subtitleLabel = new JLabel("View and manage hotel departments");        subtitleLabel.setFont(new Font("Segoe UI", Font.PLAIN, 16));        subtitleLabel.setForeground(new Color(230, 230, 250));        subtitleLabel.setHorizontalAlignment(SwingConstants.CENTER);        titlePanel.add(subtitleLabel, BorderLayout.SOUTH);        gbc.gridx = 0;        gbc.gridy = 0;        contentPanel.add(titlePanel, gbc);        // Table panel - solid background with border        tablePanel = new JPanel(new BorderLayout());        tablePanel.setOpaque(true);        tablePanel.setBackground(new Color(25, 40, 65)); // Solid dark blue        tablePanel.setBorder(BorderFactory.createCompoundBorder(                BorderFactory.createLineBorder(new Color(255, 215, 0, 150), 2),                BorderFactory.createEmptyBorder(15, 15, 15, 15)        ));        // Create table - solid colors, no transparency        table = new JTable() {            @Override            public boolean isCellEditable(int row, int column) {                return false;            }        };        table.setDoubleBuffered(true);        table.setAutoResizeMode(JTable.AUTO_RESIZE_ALL_COLUMNS);        table.setRowHeight(40);        table.setFont(new Font("Segoe UI", Font.PLAIN, 14));        table.setForeground(new Color(240, 240, 240));        table.setBackground(new Color(35, 50, 75)); // Solid color        table.setGridColor(new Color(255, 215, 0, 60));        table.setSelectionBackground(new Color(70, 130, 180));        table.setSelectionForeground(Color.WHITE);        table.setShowVerticalLines(true);        table.setShowHorizontalLines(true);        table.setOpaque(true);        // Load data        loadTableData();        // Create scroll pane        scrollPane = new JScrollPane(table);        scrollPane.setBorder(BorderFactory.createEmptyBorder());        scrollPane.getViewport().setBackground(new Color(35, 50, 75));        scrollPane.setOpaque(true);        scrollPane.getViewport().setOpaque(true);        // Set viewport properties to prevent repaint issues        JViewport viewport = scrollPane.getViewport();        viewport.setScrollMode(JViewport.BLIT_SCROLL_MODE);        viewport.setDoubleBuffered(true);        tablePanel.add(scrollPane, BorderLayout.CENTER);        // Statistics panel - solid colors        statsPanel = new JPanel(new GridLayout(1, 2, 20, 0));        statsPanel.setOpaque(true);        statsPanel.setBackground(new Color(25, 40, 65));        statsPanel.setBorder(BorderFactory.createEmptyBorder(15, 0, 0, 0));        updateStatistics();        tablePanel.add(statsPanel, BorderLayout.SOUTH);        gbc.gridy = 1;        gbc.weighty = 1.0;        gbc.fill = GridBagConstraints.BOTH;        contentPanel.add(tablePanel, gbc);        // Button panel - solid colors        JPanel buttonPanel = new JPanel(new FlowLayout(FlowLayout.CENTER, 30, 0));        buttonPanel.setOpaque(false);        buttonPanel.setBorder(BorderFactory.createEmptyBorder(20, 0, 0, 0));        JButton backBtn = createStyledButton("‚Ü©Ô∏è BACK TO DASHBOARD", new Color(70, 130, 180));        JButton refreshBtn = createStyledButton("üîÑ REFRESH", new Color(60, 179, 113));        buttonPanel.add(backBtn);        buttonPanel.add(refreshBtn);        gbc.gridy = 2;        gbc.weighty = 0.0;        gbc.fill = GridBagConstraints.HORIZONTAL;        contentPanel.add(buttonPanel, gbc);        // Set layered pane as content        setContentPane(layeredPane);        // Frame settings        setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);        setSize(900, 650);        centerWindow();        setResizable(true);        // Important: Call validate and repaint        validate();        repaint();        setVisible(true);        // Add action listeners        backBtn.addActionListener(new ActionListener() {            @Override            public void actionPerformed(ActionEvent e) {                dispose();                new C_Reception();            }        });        refreshBtn.addActionListener(new ActionListener() {            @Override            public void actionPerformed(ActionEvent e) {                refreshTable();            }        });    }    private void loadTableData() {        try {            Z_Con c = new Z_Con();            String departmentInfo = "SELECT * FROM department ORDER BY department";            ResultSet resultSet = c.statement.executeQuery(departmentInfo);            // Use invokeLater to ensure UI thread updates            SwingUtilities.invokeLater(() -> {                try {                    table.setModel(DbUtils.resultSetToTableModel(resultSet));                    // Customize columns                    if (table.getColumnCount() > 0) {                        // Table header - solid colors                        JTableHeader header = table.getTableHeader();                        header.setFont(new Font("Segoe UI", Font.BOLD, 14));                        header.setBackground(new Color(30, 60, 90));                        header.setForeground(new Color(255, 215, 0));                        header.setPreferredSize(new Dimension(header.getWidth(), 45));                        header.setOpaque(true);                        header.setReorderingAllowed(false);                        // Column widths                        if (table.getColumnCount() >= 1) {                            table.getColumnModel().getColumn(0).setPreferredWidth(300);                        }                        if (table.getColumnCount() >= 2) {                            table.getColumnModel().getColumn(1).setPreferredWidth(200);                        }                        // Create renderers with solid colors                        DefaultTableCellRenderer defaultRenderer = new DefaultTableCellRenderer() {                            @Override                            public Component getTableCellRendererComponent(JTable table, Object value,                                                                           boolean isSelected, boolean hasFocus,                                                                           int row, int column) {                                Component c = super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);                                // Force opaque                                if (c instanceof JLabel) {                                    ((JLabel) c).setOpaque(true);                                }                                // Solid colors only                                if (isSelected) {                                    c.setBackground(new Color(70, 130, 180));                                    c.setForeground(Color.WHITE);                                } else {                                    // Alternate row colors (both solid)                                    c.setBackground(row % 2 == 0 ?                                            new Color(40, 55, 80) :                                            new Color(45, 60, 85));                                    c.setForeground(new Color(240, 240, 240));                                }                                // Alignment                                if (column == 1) {                                    ((JLabel) c).setHorizontalAlignment(JLabel.RIGHT);                                } else {                                    ((JLabel) c).setHorizontalAlignment(JLabel.LEFT);                                }                                return c;                            }                        };                        // Apply renderer to all columns                        for (int i = 0; i < table.getColumnCount(); i++) {                            table.getColumnModel().getColumn(i).setCellRenderer(defaultRenderer);                        }                        // Special renderer for budget column                        DefaultTableCellRenderer budgetRenderer = new DefaultTableCellRenderer() {                            @Override                            public Component getTableCellRendererComponent(JTable table, Object value,                                                                           boolean isSelected, boolean hasFocus,                                                                           int row, int column) {                                Component c = super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);                                if (c instanceof JLabel) {                                    ((JLabel) c).setOpaque(true);                                }                                // Budget styling                                c.setForeground(new Color(255, 215, 0));                                c.setFont(new Font("Segoe UI", Font.BOLD, 14));                                ((JLabel) c).setHorizontalAlignment(JLabel.RIGHT);                                // Solid background                                if (isSelected) {                                    c.setBackground(new Color(70, 130, 180));                                } else {                                    c.setBackground(row % 2 == 0 ?                                            new Color(40, 55, 80) :                                            new Color(45, 60, 85));                                }                                return c;                            }                        };                        if (table.getColumnCount() >= 2) {                            table.getColumnModel().getColumn(1).setCellRenderer(budgetRenderer);                        }                        // Force table to repaint                        table.revalidate();                        table.repaint();                    }                } catch (Exception e) {                    e.printStackTrace();                    JOptionPane.showMessageDialog(G_Department.this,                            "Error loading department data: " + e.getMessage(),                            "Database Error",                            JOptionPane.ERROR_MESSAGE);                }            });        } catch (Exception e) {            e.printStackTrace();            JOptionPane.showMessageDialog(this,                    "Error connecting to database: " + e.getMessage(),                    "Database Error",                    JOptionPane.ERROR_MESSAGE);        }    }    private JButton createStyledButton(String text, Color baseColor) {        JButton button = new JButton(text);        // Solid button without custom painting        button.setFont(new Font("Segoe UI", Font.BOLD, 14));        button.setForeground(Color.WHITE);        button.setBackground(baseColor);        button.setFocusPainted(false);        button.setBorder(BorderFactory.createCompoundBorder(                BorderFactory.createLineBorder(new Color(255, 215, 0), 2),                BorderFactory.createEmptyBorder(12, 25, 12, 25)        ));        button.setCursor(new Cursor(Cursor.HAND_CURSOR));        button.setOpaque(true);        // Hover effect using mouse listener        button.addMouseListener(new java.awt.event.MouseAdapter() {            public void mouseEntered(java.awt.event.MouseEvent evt) {                button.setBackground(baseColor.brighter());                button.setBorder(BorderFactory.createCompoundBorder(                        BorderFactory.createLineBorder(new Color(255, 215, 0, 200), 2),                        BorderFactory.createEmptyBorder(12, 25, 12, 25)                ));            }            public void mouseExited(java.awt.event.MouseEvent evt) {                button.setBackground(baseColor);                button.setBorder(BorderFactory.createCompoundBorder(                        BorderFactory.createLineBorder(new Color(255, 215, 0), 2),                        BorderFactory.createEmptyBorder(12, 25, 12, 25)                ));            }        });        return button;    }    private JPanel createStatCard(String icon, String title, String value, Color color) {        JPanel card = new JPanel(new BorderLayout());        card.setOpaque(true);        card.setBackground(new Color(color.getRed(), color.getGreen(), color.getBlue()));        card.setBorder(BorderFactory.createCompoundBorder(                BorderFactory.createLineBorder(new Color(255, 255, 255, 150), 1),                BorderFactory.createEmptyBorder(20, 20, 20, 20)        ));        JPanel contentPanel = new JPanel();        contentPanel.setOpaque(false);        contentPanel.setLayout(new BoxLayout(contentPanel, BoxLayout.Y_AXIS));        JLabel iconLabel = new JLabel(icon, SwingConstants.CENTER);        iconLabel.setFont(new Font("Segoe UI Emoji", Font.PLAIN, 32));        iconLabel.setForeground(Color.WHITE);        iconLabel.setAlignmentX(Component.CENTER_ALIGNMENT);        JLabel titleLabel = new JLabel(title, SwingConstants.CENTER);        titleLabel.setFont(new Font("Segoe UI", Font.BOLD, 14));        titleLabel.setForeground(new Color(240, 240, 240));        titleLabel.setAlignmentX(Component.CENTER_ALIGNMENT);        JLabel valueLabel = new JLabel(value, SwingConstants.CENTER);        valueLabel.setFont(new Font("Segoe UI", Font.BOLD, 22));        valueLabel.setForeground(Color.WHITE);        valueLabel.setAlignmentX(Component.CENTER_ALIGNMENT);        contentPanel.add(iconLabel);        contentPanel.add(Box.createVerticalStrut(10));        contentPanel.add(titleLabel);        contentPanel.add(Box.createVerticalStrut(5));        contentPanel.add(valueLabel);        card.add(contentPanel, BorderLayout.CENTER);        return card;    }    private double calculateTotalBudget() {        double total = 0;        try {            Z_Con c = new Z_Con();            ResultSet rs = c.statement.executeQuery("SELECT SUM(budget) FROM department");            if (rs.next()) {                total = rs.getDouble(1);            }        } catch (Exception e) {            e.printStackTrace();        }        return total;    }    private void refreshTable() {        // Disable buttons during refresh        Component[] components = getContentPane().getComponents();        for (Component comp : components) {            if (comp instanceof JButton) {                comp.setEnabled(false);            }        }        SwingWorker<Void, Void> worker = new SwingWorker<Void, Void>() {            @Override            protected Void doInBackground() throws Exception {                try {                    Z_Con c = new Z_Con();                    String departmentInfo = "SELECT * FROM department ORDER BY department";                    ResultSet resultSet = c.statement.executeQuery(departmentInfo);                    SwingUtilities.invokeLater(() -> {                        try {                            table.setModel(DbUtils.resultSetToTableModel(resultSet));                            updateStatistics();                            JOptionPane.showMessageDialog(G_Department.this,                                    "Department data refreshed successfully!\n" +                                            "Total Departments: " + table.getRowCount() + "\n" +                                            "Total Budget: $" + String.format("%,.2f", calculateTotalBudget()),                                    "Refresh Complete",                                    JOptionPane.INFORMATION_MESSAGE);                        } catch (Exception e) {                            e.printStackTrace();                            JOptionPane.showMessageDialog(G_Department.this,                                    "Error refreshing data: " + e.getMessage(),                                    "Refresh Error",                                    JOptionPane.ERROR_MESSAGE);                        }                    });                } catch (Exception e) {                    e.printStackTrace();                    SwingUtilities.invokeLater(() -> {                        JOptionPane.showMessageDialog(G_Department.this,                                "Error refreshing data: " + e.getMessage(),                                "Refresh Error",                                JOptionPane.ERROR_MESSAGE);                    });                }                return null;            }            @Override            protected void done() {                // Re-enable buttons                Component[] components = getContentPane().getComponents();                for (Component comp : components) {                    if (comp instanceof JButton) {                        comp.setEnabled(true);                    }                }                // Force repaint                revalidate();                repaint();            }        };        worker.execute();    }    private void updateStatistics() {        SwingUtilities.invokeLater(() -> {            int totalDepartments = table.getRowCount();            double totalBudget = calculateTotalBudget();            // Clear and recreate stats panel            statsPanel.removeAll();            Color[] statsColors = {                    new Color(70, 130, 180),   // Steel Blue                    new Color(60, 179, 113)    // Medium Sea Green            };            String[][] statsData = {                    {"üè¢", "Total Departments", String.valueOf(totalDepartments)},                    {"üí∞", "Total Budget", String.format("$%,.2f", totalBudget)}            };            for (int i = 0; i < statsData.length; i++) {                statsPanel.add(createStatCard(statsData[i][0], statsData[i][1], statsData[i][2], statsColors[i]));            }            statsPanel.revalidate();            statsPanel.repaint();            // Force repaint of entire UI            revalidate();            repaint();        });    }    private void centerWindow() {        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();        int x = (screenSize.width - getWidth()) / 2;        int y = (screenSize.height - getHeight()) / 2;        setLocation(x, y);    }    public static void main(String[] args) {        try {            // Use system look and feel            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());            // Set some UI defaults            UIManager.put("ScrollBar.thumb", new Color(70, 130, 180));            UIManager.put("ScrollBar.thumbShadow", new Color(50, 100, 150));            UIManager.put("ScrollBar.track", new Color(30, 60, 90));        } catch (Exception e) {            e.printStackTrace();        }        SwingUtilities.invokeLater(() -> {            try {                new G_Department();            } catch (Exception e) {                e.printStackTrace();                JOptionPane.showMessageDialog(null,                        "Error creating department window: " + e.getMessage(),                        "Application Error",                        JOptionPane.ERROR_MESSAGE);            }        });    }}