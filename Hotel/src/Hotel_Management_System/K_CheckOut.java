package Hotel_Management_System;import javax.swing.*;import java.awt.*;import java.awt.event.ActionEvent;import java.awt.event.ActionListener;import java.sql.ResultSet;import java.sql.PreparedStatement;import java.text.SimpleDateFormat;import java.util.Date;public class K_CheckOut extends JFrame {    K_CheckOut(){        super("Check-Out Management");        // Main panel with gradient background        JPanel mainPanel = new JPanel() {            @Override            protected void paintComponent(Graphics g) {                super.paintComponent(g);                Graphics2D g2d = (Graphics2D) g;                g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);                // Professional gradient background                GradientPaint gradient = new GradientPaint(                        0, 0, new Color(20, 35, 50),      // Dark blue-gray                        getWidth(), getHeight(), new Color(50, 25, 60)  // Dark purple-gray                );                g2d.setPaint(gradient);                g2d.fillRect(0, 0, getWidth(), getHeight());            }        };        mainPanel.setLayout(new BorderLayout());        mainPanel.setBorder(BorderFactory.createEmptyBorder(30, 30, 30, 30));        // Content panel        JPanel contentPanel = new JPanel();        contentPanel.setLayout(new BorderLayout());        contentPanel.setOpaque(false);        // Title panel        JPanel titlePanel = new JPanel(new BorderLayout());        titlePanel.setOpaque(false);        JLabel titleLabel = new JLabel("üè® CHECK-OUT MANAGEMENT");        titleLabel.setFont(new Font("Segoe UI", Font.BOLD, 28));        titleLabel.setForeground(new Color(255, 215, 0)); // Gold color        titleLabel.setHorizontalAlignment(SwingConstants.CENTER);        titleLabel.setBorder(BorderFactory.createEmptyBorder(0, 0, 20, 0));        titlePanel.add(titleLabel, BorderLayout.CENTER);        JLabel subtitleLabel = new JLabel("Process customer check-out and room availability");        subtitleLabel.setFont(new Font("Segoe UI", Font.PLAIN, 14));        subtitleLabel.setForeground(new Color(220, 220, 240));        subtitleLabel.setHorizontalAlignment(SwingConstants.CENTER);        titlePanel.add(subtitleLabel, BorderLayout.SOUTH);        contentPanel.add(titlePanel, BorderLayout.NORTH);        // Form panel with border        JPanel formPanel = new JPanel();        formPanel.setLayout(null);        formPanel.setOpaque(false);        formPanel.setBorder(BorderFactory.createCompoundBorder(                BorderFactory.createLineBorder(new Color(255, 215, 0, 80), 2),                BorderFactory.createEmptyBorder(25, 25, 25, 25)        ));        // Form labels and fields        JLabel customerIdLabel = new JLabel("Customer ID:");        customerIdLabel.setBounds(50, 30, 150, 30);        customerIdLabel.setFont(new Font("Segoe UI", Font.BOLD, 14));        customerIdLabel.setForeground(new Color(240, 240, 240));        formPanel.add(customerIdLabel);        JComboBox<String> customerComboBox = new JComboBox<>();        customerComboBox.setBounds(220, 30, 250, 35);        customerComboBox.setFont(new Font("Segoe UI", Font.PLAIN, 13));        customerComboBox.setBackground(Color.WHITE);        customerComboBox.setForeground(Color.BLACK);        formPanel.add(customerComboBox);        JLabel roomNumLabel = new JLabel("Room Number:");        roomNumLabel.setBounds(50, 80, 150, 30);        roomNumLabel.setFont(new Font("Segoe UI", Font.BOLD, 14));        roomNumLabel.setForeground(new Color(240, 240, 240));        formPanel.add(roomNumLabel);        JLabel roomNumberValue = new JLabel();        roomNumberValue.setBounds(220, 80, 250, 30);        roomNumberValue.setFont(new Font("Segoe UI", Font.BOLD, 14));        roomNumberValue.setForeground(new Color(255, 215, 0)); // Gold for values        formPanel.add(roomNumberValue);        JLabel checkInTimeLabel = new JLabel("Check-In Date:");        checkInTimeLabel.setBounds(50, 130, 150, 30);        checkInTimeLabel.setFont(new Font("Segoe UI", Font.BOLD, 14));        checkInTimeLabel.setForeground(new Color(240, 240, 240));        formPanel.add(checkInTimeLabel);        JLabel checkInTimeValue = new JLabel();        checkInTimeValue.setBounds(220, 130, 250, 30);        checkInTimeValue.setFont(new Font("Segoe UI", Font.PLAIN, 13));        checkInTimeValue.setForeground(new Color(135, 206, 250)); // Light blue        formPanel.add(checkInTimeValue);        JLabel checkOutTimeLabel = new JLabel("Check-Out Time:");        checkOutTimeLabel.setBounds(50, 180, 150, 30);        checkOutTimeLabel.setFont(new Font("Segoe UI", Font.BOLD, 14));        checkOutTimeLabel.setForeground(new Color(240, 240, 240));        formPanel.add(checkOutTimeLabel);        // Format current date nicely        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");        Date date = new Date();        String formattedDate = sdf.format(date);        JLabel checkOutTimeValue = new JLabel(formattedDate);        checkOutTimeValue.setBounds(220, 180, 250, 30);        checkOutTimeValue.setFont(new Font("Segoe UI", Font.BOLD, 13));        checkOutTimeValue.setForeground(new Color(50, 205, 50)); // Lime green        formPanel.add(checkOutTimeValue);        // Customer Information Panel        JPanel customerInfoPanel = new JPanel();        customerInfoPanel.setLayout(new GridLayout(0, 2, 10, 5));        customerInfoPanel.setBounds(500, 30, 300, 180);        customerInfoPanel.setOpaque(false);        customerInfoPanel.setBorder(BorderFactory.createTitledBorder(                BorderFactory.createLineBorder(new Color(255, 215, 0, 80), 1),                "Customer Information"        ));        JLabel nameLabel = new JLabel("Name:");        JLabel nameValue = new JLabel();        JLabel depositLabel = new JLabel("Deposit:");        JLabel depositValue = new JLabel();        JLabel phoneLabel = new JLabel("Phone:");        JLabel phoneValue = new JLabel();        JLabel emailLabel = new JLabel("Email:");        JLabel emailValue = new JLabel();        nameLabel.setForeground(new Color(240, 240, 240));        depositLabel.setForeground(new Color(240, 240, 240));        phoneLabel.setForeground(new Color(240, 240, 240));        emailLabel.setForeground(new Color(240, 240, 240));        nameValue.setForeground(new Color(255, 215, 0));        depositValue.setForeground(new Color(255, 215, 0));        phoneValue.setForeground(new Color(135, 206, 250));        emailValue.setForeground(new Color(135, 206, 250));        customerInfoPanel.add(nameLabel);        customerInfoPanel.add(nameValue);        customerInfoPanel.add(depositLabel);        customerInfoPanel.add(depositValue);        customerInfoPanel.add(phoneLabel);        customerInfoPanel.add(phoneValue);        customerInfoPanel.add(emailLabel);        customerInfoPanel.add(emailValue);        formPanel.add(customerInfoPanel);        // Status label        JLabel statusLabel = new JLabel("Status:");        statusLabel.setBounds(50, 230, 150, 30);        statusLabel.setFont(new Font("Segoe UI", Font.BOLD, 14));        statusLabel.setForeground(new Color(240, 240, 240));        formPanel.add(statusLabel);        JLabel statusValue = new JLabel("Active");        statusValue.setBounds(220, 230, 250, 30);        statusValue.setFont(new Font("Segoe UI", Font.BOLD, 14));        statusValue.setForeground(new Color(50, 205, 50)); // Green for active        formPanel.add(statusValue);        // Load customer IDs into combo box        loadCustomerIds(customerComboBox);        // Button panel        JPanel buttonPanel = new JPanel();        buttonPanel.setLayout(new FlowLayout(FlowLayout.CENTER, 20, 0));        buttonPanel.setBounds(50, 280, 750, 50);        buttonPanel.setOpaque(false);        formPanel.add(buttonPanel);        // Create styled buttons        JButton checkButton = createStyledButton("üîç CHECK", new Color(70, 130, 180)); // Steel blue        JButton backButton = createStyledButton("‚Üê BACK", new Color(100, 100, 120)); // Gray        JButton checkOutButton = createStyledButton("‚úì CHECK-OUT", new Color(60, 179, 113)); // Medium sea green        JButton refreshButton = createStyledButton("üîÑ REFRESH", new Color(138, 43, 226)); // Blue violet        buttonPanel.add(checkButton);        buttonPanel.add(refreshButton);        buttonPanel.add(backButton);        buttonPanel.add(checkOutButton);        contentPanel.add(formPanel, BorderLayout.CENTER);        mainPanel.add(contentPanel, BorderLayout.CENTER);        add(mainPanel);        // Frame settings        setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);        setSize(900, 600);        centerWindow(); // Center the window on screen        setResizable(false);        setVisible(true);        // Check button action - Load customer details        checkButton.addActionListener(new ActionListener() {            @Override            public void actionPerformed(ActionEvent e) {                String selectedCustomerId = (String) customerComboBox.getSelectedItem();                if (selectedCustomerId != null && !selectedCustomerId.isEmpty()) {                    loadCustomerDetails(selectedCustomerId, roomNumberValue, checkInTimeValue,                            nameValue, depositValue, phoneValue, emailValue, statusValue);                } else {                    JOptionPane.showMessageDialog(K_CheckOut.this,                            "Please select a customer ID first.",                            "No Selection",                            JOptionPane.WARNING_MESSAGE);                }            }        });        // Check-Out button action        checkOutButton.addActionListener(new ActionListener() {            @Override            public void actionPerformed(ActionEvent e) {                String selectedCustomerId = (String) customerComboBox.getSelectedItem();                String roomNumber = roomNumberValue.getText();                if (selectedCustomerId == null || selectedCustomerId.isEmpty()) {                    JOptionPane.showMessageDialog(K_CheckOut.this,                            "Please select a customer first.",                            "No Customer Selected",                            JOptionPane.WARNING_MESSAGE);                    return;                }                if (roomNumber.isEmpty()) {                    JOptionPane.showMessageDialog(K_CheckOut.this,                            "Please check customer details first.",                            "No Room Information",                            JOptionPane.WARNING_MESSAGE);                    return;                }                // Confirm check-out                int confirm = JOptionPane.showConfirmDialog(K_CheckOut.this,                        "Are you sure you want to check-out customer ID: " + selectedCustomerId + "?\n" +                                "Name: " + nameValue.getText() + "\n" +                                "Room: " + roomNumber + "\n\n" +                                "This will update room status and mark customer as checked out.",                        "Confirm Check-Out",                        JOptionPane.YES_NO_OPTION,                        JOptionPane.QUESTION_MESSAGE);                if (confirm == JOptionPane.YES_OPTION) {                    processCheckOut(selectedCustomerId, roomNumber, customerComboBox, nameValue,                            roomNumberValue, checkInTimeValue, checkOutTimeValue, depositValue,                            phoneValue, emailValue, statusValue);                }            }        });        // Refresh button action        refreshButton.addActionListener(new ActionListener() {            @Override            public void actionPerformed(ActionEvent e) {                // Clear all fields                customerComboBox.setSelectedIndex(0);                roomNumberValue.setText("");                checkInTimeValue.setText("");                checkOutTimeValue.setText(sdf.format(new Date())); // Update current time                nameValue.setText("");                depositValue.setText("");                phoneValue.setText("");                emailValue.setText("");                statusValue.setText("Active");                statusValue.setForeground(new Color(50, 205, 50));                // Reload customer IDs                loadCustomerIds(customerComboBox);                JOptionPane.showMessageDialog(K_CheckOut.this,                        "Form refreshed successfully!",                        "Refresh Complete",                        JOptionPane.INFORMATION_MESSAGE);            }        });        // Back button action        backButton.addActionListener(new ActionListener() {            @Override            public void actionPerformed(ActionEvent e) {                dispose();                new C_Reception();            }        });    }    // Method to load customer IDs into combo box    private void loadCustomerIds(JComboBox<String> comboBox) {        try {            Z_Con c = new Z_Con();            // FIXED: Changed to match your database schema - customer_id instead of id_number            ResultSet resultSet = c.statement.executeQuery("SELECT customer_id FROM customer ORDER BY customer_id");            comboBox.removeAllItems();            comboBox.addItem(""); // Empty first option            int count = 0;            while (resultSet.next()) {                comboBox.addItem(resultSet.getString("customer_id"));                count++;            }            System.out.println("Loaded " + count + " customer IDs");        } catch (Exception e) {            e.printStackTrace();            JOptionPane.showMessageDialog(this,                    "Error loading customer IDs: " + e.getMessage(),                    "Database Error",                    JOptionPane.ERROR_MESSAGE);        }    }    // Method to load customer details    private void loadCustomerDetails(String customerId, JLabel roomLabel, JLabel checkInLabel,                                     JLabel nameLabel, JLabel depositLabel, JLabel phoneLabel,                                     JLabel emailLabel, JLabel statusLabel) {        try {            Z_Con c = new Z_Con();            // FIXED: Updated query to match your database schema            ResultSet resultSet = c.statement.executeQuery(                    "SELECT first_name, last_name, room_number, checkin_date, deposit, phone, email " +                            "FROM customer WHERE customer_id = " + customerId);            if (resultSet.next()) {                String firstName = resultSet.getString("first_name");                String lastName = resultSet.getString("last_name");                String roomNumber = resultSet.getString("room_number");                String checkinDate = resultSet.getString("checkin_date");                double deposit = resultSet.getDouble("deposit");                String phone = resultSet.getString("phone");                String email = resultSet.getString("email");                roomLabel.setText(roomNumber != null ? roomNumber : "Not Assigned");                checkInLabel.setText(checkinDate != null ? checkinDate : "Not Available");                nameLabel.setText(firstName != null ? firstName + " " + lastName : "Not Available");                depositLabel.setText(deposit > 0 ? String.format("$%,.2f", deposit) : "$0.00");                phoneLabel.setText(phone != null ? phone : "Not Available");                emailLabel.setText(email != null ? email : "Not Available");                // Check if customer is already checked out (no room assignment)                if (roomNumber == null || roomNumber.isEmpty()) {                    statusLabel.setText("Checked Out");                    statusLabel.setForeground(new Color(255, 69, 0)); // Red-Orange                } else {                    statusLabel.setText("Active");                    statusLabel.setForeground(new Color(50, 205, 50)); // Green                }                System.out.println("Loaded details for customer " + customerId + ": " + firstName + " " + lastName);            } else {                clearCustomerDetails(roomLabel, checkInLabel, nameLabel, depositLabel, phoneLabel, emailLabel, statusLabel);                JOptionPane.showMessageDialog(this,                        "Customer not found in database.",                        "Not Found",                        JOptionPane.WARNING_MESSAGE);            }        } catch (Exception e) {            e.printStackTrace();            JOptionPane.showMessageDialog(this,                    "Error loading customer details: " + e.getMessage(),                    "Database Error",                    JOptionPane.ERROR_MESSAGE);        }    }    // Method to process check-out (without deleting from database)    private void processCheckOut(String customerId, String roomNumber, JComboBox<String> comboBox,                                 JLabel nameLabel, JLabel roomLabel, JLabel checkInLabel,                                 JLabel checkOutLabel, JLabel depositLabel, JLabel phoneLabel,                                 JLabel emailLabel, JLabel statusLabel) {        try {            Z_Con c = new Z_Con();            // Get current customer information            ResultSet customerInfo = c.statement.executeQuery(                    "SELECT first_name, last_name, deposit FROM customer WHERE customer_id = " + customerId);            String firstName = "";            String lastName = "";            double deposit = 0;            if (customerInfo.next()) {                firstName = customerInfo.getString("first_name");                lastName = customerInfo.getString("last_name");                deposit = customerInfo.getDouble("deposit");            }            // 1. Update bookings table (mark as completed)            try {                String updateBookingQuery = "UPDATE bookings SET status = 'Checked Out', checkout_date = NOW() WHERE customer_id = ? AND room_number = ? AND status = 'Active'";                PreparedStatement bookingStmt = c.connection.prepareStatement(updateBookingQuery);                bookingStmt.setInt(1, Integer.parseInt(customerId));                bookingStmt.setInt(2, Integer.parseInt(roomNumber));                int bookingUpdated = bookingStmt.executeUpdate();                bookingStmt.close();                System.out.println("Updated " + bookingUpdated + " booking records");            } catch (Exception bookingEx) {                System.out.println("Warning: Could not update bookings table: " + bookingEx.getMessage());            }            // 2. Update customer table - set room_number to NULL instead of deleting            String updateCustomerQuery = "UPDATE customer SET room_number = NULL WHERE customer_id = ?";            PreparedStatement customerStmt = c.connection.prepareStatement(updateCustomerQuery);            customerStmt.setInt(1, Integer.parseInt(customerId));            int customerUpdated = customerStmt.executeUpdate();            customerStmt.close();            System.out.println("Updated customer: " + customerUpdated + " rows affected");            // 3. Update room availability            String updateRoomQuery = "UPDATE room SET availability = 'Available', cleaning_status = 'Dirty' WHERE room_number = ?";            PreparedStatement roomStmt = c.connection.prepareStatement(updateRoomQuery);            roomStmt.setInt(1, Integer.parseInt(roomNumber));            int roomUpdated = roomStmt.executeUpdate();            roomStmt.close();            System.out.println("Updated room: " + roomUpdated + " rows affected");            // Success message            JOptionPane.showMessageDialog(this,                    "‚úÖ Check-out completed successfully!\n\n" +                            "Customer: " + firstName + " " + lastName + "\n" +                            "Customer ID: " + customerId + "\n" +                            "Room: " + roomNumber + "\n" +                            "Deposit to refund: $" + String.format("%,.2f", deposit) + "\n" +                            "Check-out Time: " + new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(new Date()) + "\n\n" +                            "‚úì Customer record preserved in database\n" +                            "‚úì Room marked as available for cleaning\n" +                            "‚úì Booking status updated to 'Checked Out'",                    "Check-Out Complete",                    JOptionPane.INFORMATION_MESSAGE);            // Clear form and reload customer IDs            clearCustomerDetails(roomLabel, checkInLabel, nameLabel, depositLabel, phoneLabel, emailLabel, statusLabel);            checkOutLabel.setText(new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(new Date()));            comboBox.setSelectedIndex(0);            loadCustomerIds(comboBox);        } catch (Exception e) {            e.printStackTrace();            JOptionPane.showMessageDialog(this,                    "Error during check-out: " + e.getMessage(),                    "Check-Out Error",                    JOptionPane.ERROR_MESSAGE);        }    }    // Method to clear customer details    private void clearCustomerDetails(JLabel roomLabel, JLabel checkInLabel,                                      JLabel nameLabel, JLabel depositLabel, JLabel phoneLabel,                                      JLabel emailLabel, JLabel statusLabel) {        roomLabel.setText("");        checkInLabel.setText("");        nameLabel.setText("");        depositLabel.setText("");        phoneLabel.setText("");        emailLabel.setText("");        statusLabel.setText("Active");        statusLabel.setForeground(new Color(50, 205, 50));    }    // Method to create styled buttons    private JButton createStyledButton(String text, Color baseColor) {        JButton button = new JButton(text);        button.setFont(new Font("Segoe UI", Font.BOLD, 13));        button.setForeground(Color.WHITE);        button.setBackground(baseColor);        button.setFocusPainted(false);        button.setBorder(BorderFactory.createCompoundBorder(                BorderFactory.createLineBorder(new Color(255, 215, 0), 1),                BorderFactory.createEmptyBorder(10, 20, 10, 20)        ));        button.setCursor(new Cursor(Cursor.HAND_CURSOR));        // Hover effect        button.addMouseListener(new java.awt.event.MouseAdapter() {            public void mouseEntered(java.awt.event.MouseEvent evt) {                button.setBackground(baseColor.brighter());                button.setBorder(BorderFactory.createCompoundBorder(                        BorderFactory.createLineBorder(new Color(255, 215, 0, 200), 2),                        BorderFactory.createEmptyBorder(10, 20, 10, 20)                ));            }            public void mouseExited(java.awt.event.MouseEvent evt) {                button.setBackground(baseColor);                button.setBorder(BorderFactory.createCompoundBorder(                        BorderFactory.createLineBorder(new Color(255, 215, 0), 1),                        BorderFactory.createEmptyBorder(10, 20, 10, 20)                ));            }        });        return button;    }    // Method to center the window on screen    private void centerWindow() {        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();        int x = (screenSize.width - getWidth()) / 2;        int y = (screenSize.height - getHeight()) / 2;        setLocation(x, y);    }    public static void main(String[] args) {        // Set system look and feel        try {            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());        } catch (Exception e) {            e.printStackTrace();        }        SwingUtilities.invokeLater(() -> {            new K_CheckOut();        });    }}